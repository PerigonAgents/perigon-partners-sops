<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perigon Partners - Time Tracking Tool SOP v1</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap');
    :root {
      --green:#2cac6c;--green-light:#2cac6c;--green-pale:#eef8f3;
      --dark:#1d3657;--body:#1d3657;--muted:#6b7a8d;
      --border:#e8eaed;--bg:#f7f8f9;
      --warn-bg:#FFF7ED;--warn-border:#FB923C;--warn-text:#9A3412;
      --info-bg:#EFF6FF;--info-border:#3B82F6;--info-text:#1E40AF;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Montserrat',sans-serif;color:var(--body);line-height:1.7;background:#fff;}
    .cover{background:var(--green);color:white;padding:56px 64px 48px;overflow:hidden;position:relative;}
    .cover::after{content:'';position:absolute;top:-60px;right:-60px;width:280px;height:280px;border-radius:50%;background:rgba(255,255,255,.06);}
    .cover-label{font-size:11px;font-weight:600;letter-spacing:2px;text-transform:uppercase;opacity:.7;margin-bottom:12px;}
    .cover h1{font-size:32px;font-weight:700;line-height:1.25;margin-bottom:8px;}
    .cover-sub{font-size:16px;opacity:.8;margin-bottom:32px;}
    .cover-meta{display:flex;gap:32px;font-size:13px;opacity:.7;flex-wrap:wrap;}
    .cover-meta strong{display:block;font-weight:600;opacity:1;margin-bottom:2px;}
    .content{max-width:860px;margin:0 auto;padding:48px 64px 80px;}
    .toc{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:28px 32px;margin-bottom:48px;}
    .toc h2{font-size:11px;font-weight:600;letter-spacing:1.5px;text-transform:uppercase;color:var(--muted);margin-bottom:16px;}
    .toc ol{padding-left:20px;} .toc li{margin-bottom:6px;font-size:14px;}
    .toc a{color:var(--green);text-decoration:none;font-weight:500;}
    .toc a:hover{text-decoration:underline;}
    .toc .sub{padding-left:20px;margin-top:4px;list-style-type:lower-alpha;} .toc .sub li{margin-bottom:3px;}
    .section{margin-bottom:56px;}
    .section-label{font-size:11px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--green-light);margin-bottom:6px;}
    h2.section-title{font-size:24px;font-weight:700;color:var(--dark);margin-bottom:20px;padding-bottom:12px;border-bottom:2px solid var(--green-pale);}
    h3{font-size:16px;font-weight:600;color:var(--dark);margin:28px 0 10px;}
    p{margin-bottom:14px;font-size:15px;} ul,ol{padding-left:22px;margin-bottom:14px;font-size:15px;} li{margin-bottom:6px;}
    .steps{counter-reset:step;list-style:none;padding:0;}
    .steps li{counter-increment:step;position:relative;padding:18px 20px 18px 64px;background:var(--bg);border:1px solid var(--border);border-radius:10px;margin-bottom:12px;font-size:15px;}
    .steps li::before{content:counter(step);position:absolute;left:18px;top:50%;transform:translateY(-50%);width:32px;height:32px;background:var(--green);color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:13px;}
    .steps li strong{display:block;font-weight:600;margin-bottom:3px;}
    .steps li .note{display:block;margin-top:6px;font-size:13px;color:var(--muted);font-style:italic;}
    .callout{border-radius:8px;padding:16px 20px;margin:20px 0;font-size:14px;display:flex;gap:12px;}
    .callout-icon{font-size:18px;flex-shrink:0;margin-top:1px;}
    .callout.warning{background:var(--warn-bg);border-left:4px solid var(--warn-border);}
    .callout.warning p{color:var(--warn-text);margin:0;}
    .callout.info{background:var(--info-bg);border-left:4px solid var(--info-border);}
    .callout.info p{color:var(--info-text);margin:0;}
    .callout.tip{background:var(--green-pale);border-left:4px solid var(--green);}
    .callout.tip p{color:#1B4332;margin:0;}
    .flow{display:flex;align-items:stretch;flex-wrap:wrap;gap:0;margin:24px 0 32px;}
    .flow-step{flex:1;min-width:100px;background:var(--green-pale);border:1px solid var(--green-light);border-radius:8px;padding:14px 12px;text-align:center;}
    .flow-num{display:inline-block;background:var(--green);color:white;border-radius:50%;width:22px;height:22px;font-size:11px;font-weight:700;line-height:22px;margin-bottom:8px;}
    .flow-label{font-size:11px;font-weight:600;color:#1B4332;line-height:1.4;}
    .flow-tool{font-size:10px;color:var(--green);margin-top:4px;font-weight:500;}
    .flow-arrow{display:flex;align-items:center;padding:0 4px;color:var(--green-light);font-size:18px;flex-shrink:0;}
    .trouble-item{border:1px solid var(--border);border-radius:10px;overflow:hidden;margin-bottom:16px;}
    .trouble-problem{background:var(--dark);color:white;padding:14px 20px;font-size:14px;font-weight:600;}
    .trouble-body{padding:16px 20px;}
    .trouble-body p{font-size:14px;margin-bottom:8px;} .trouble-body ul{font-size:14px;margin-bottom:0;}
    .trouble-label{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:6px;}
    .timeline{position:relative;padding-left:32px;margin:20px 0;}
    .timeline::before{content:'';position:absolute;left:8px;top:8px;bottom:8px;width:2px;background:var(--green-pale);}
    .timeline-item{position:relative;margin-bottom:20px;}
    .timeline-item::before{content:'';position:absolute;left:-28px;top:6px;width:10px;height:10px;border-radius:50%;background:var(--green);}
    .timeline-item .time{font-size:12px;font-weight:600;color:var(--green);text-transform:uppercase;letter-spacing:.5px;}
    .timeline-item p{font-size:14px;margin:2px 0 0;}
    .zap-step{border:1px solid var(--border);border-radius:10px;overflow:hidden;margin-bottom:20px;}
    .zap-header{display:flex;align-items:center;gap:16px;background:var(--dark);color:white;padding:16px 20px;}
    .zap-num{width:34px;height:34px;background:var(--green);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;flex-shrink:0;}
    .zap-title{font-size:15px;font-weight:600;line-height:1.3;} .zap-app{font-size:12px;opacity:.6;margin-top:2px;}
    .zap-body{padding:20px;} .zap-body p{font-size:14px;margin-bottom:12px;}
    .zap-config{background:var(--bg);border:1px solid var(--border);border-radius:8px;overflow:hidden;margin:12px 0;}
    .zap-row{display:flex;justify-content:space-between;padding:9px 14px;border-bottom:1px solid var(--border);font-size:13px;}
    .zap-row:last-child{border-bottom:none;}
    .zap-row span:first-child{color:var(--muted);font-weight:500;flex:0 0 46%;}
    .zap-row span:last-child{font-weight:600;color:var(--dark);flex:0 0 52%;}
    .zap-code{background:#1e2a3a;border-radius:8px;padding:14px 16px;font-size:12px;color:#a8d9b8;line-height:1.6;margin-top:12px;white-space:pre-wrap;font-family:monospace;overflow-x:auto;}
    .zap-code-label{font-size:10px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:var(--muted);margin-bottom:8px;}
    .loop-badge{display:inline-block;background:#7c3aed;color:white;font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;padding:2px 8px;border-radius:4px;margin-left:8px;vertical-align:middle;}
    table{width:100%;border-collapse:collapse;font-size:14px;margin-bottom:14px;}
    th{background:var(--green);color:white;padding:12px 16px;text-align:left;}
    th:first-child{border-radius:8px 0 0 0;} th:last-child{border-radius:0 8px 0 0;}
    td{padding:10px 16px;border-bottom:1px solid var(--border);vertical-align:top;}
    tr:nth-child(even) td{background:var(--bg);}
    code{background:var(--green-pale);color:#1a5c3a;padding:2px 6px;border-radius:4px;font-family:monospace;font-size:12px;}
    .sheet-card{border:1px solid var(--border);border-radius:10px;overflow:hidden;margin-bottom:16px;}
    .sheet-header{display:flex;align-items:center;gap:12px;padding:14px 20px;background:var(--dark);color:white;font-size:15px;font-weight:600;}
    .sheet-emoji{font-size:20px;}
    .sheet-body{padding:16px 20px;font-size:14px;}
    .sheet-body p{font-size:14px;margin-bottom:8px;}
    .sheet-body ul{font-size:14px;margin-bottom:0;}
    .badge{display:inline-block;font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;padding:2px 8px;border-radius:4px;margin-left:8px;vertical-align:middle;}
    .badge-restricted{background:#ef4444;color:white;}
    .badge-auto{background:var(--green);color:white;}
    .badge-ceo{background:#7c3aed;color:white;}
    footer{text-align:center;padding:32px 64px;font-size:12px;color:var(--muted);border-top:1px solid var(--border);}
    @media(max-width:700px){
      .content{padding:24px 20px 48px;} .cover{padding:36px 24px 32px;}
      .cover-meta{flex-direction:column;gap:12px;}
      .flow{flex-direction:column;} .flow-arrow{transform:rotate(90deg);justify-content:center;}
    }
  </style>
</head>
<body>

<div class="cover">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:32px;flex-wrap:wrap;gap:16px;">
    <img src="https://cdn.prod.website-files.com/688cc4f9806ddae7e1e220e9/688cd5dbb1b1f69db17f0f05_Perigon%20Logo%20Large%20White%20Cropped.png" alt="Perigon Partners" style="height:40px;width:auto;"/>
    <a href="index.html" style="font-size:13px;color:rgba(255,255,255,0.7);text-decoration:none;font-weight:500;">&#8592; All SOPs</a>
  </div>
  <div class="cover-label">Standard Operating Procedure</div>
  <h1>Time Tracking Tool</h1>
  <div class="cover-sub">How to log time, read your dashboard, and manage the Perigon time tracking system</div>
  <div class="cover-meta">
    <div><strong>Organisation</strong>Perigon Partners</div>
    <div><strong>Version</strong>1.0</div>
    <div><strong>Last updated</strong>February 2026</div>
    <div><strong>System owner</strong>Sally Weatherly, Growth &amp; Operations Lead</div>
  </div>
</div>

<div class="content">

  <div class="toc">
    <h2>Contents</h2>
    <ol>
      <li><a href="#overview">Overview &amp; How it works</a></li>
      <li><a href="#clockify">Logging time in Clockify</a>
        <ol class="sub">
          <li><a href="#clockify-daily">Daily time entry</a></li>
          <li><a href="#clockify-naming">Project naming rules</a></li>
          <li><a href="#clockify-weekly">Weekly review</a></li>
        </ol>
      </li>
      <li><a href="#spreadsheet">The Master Time Log spreadsheet</a>
        <ol class="sub">
          <li><a href="#sheets-guide">Sheet-by-sheet guide</a></li>
          <li><a href="#dashboard">Reading your personal dashboard</a></li>
          <li><a href="#emma-view">Emma's financial view</a></li>
        </ol>
      </li>
      <li><a href="#projects">Managing projects</a></li>
      <li><a href="#troubleshoot">Troubleshooting</a></li>
      <li><a href="#zapier">Zapier technical reference</a></li>
    </ol>
  </div>

  <!-- SECTION 1 -->
  <div class="section" id="overview">
    <div class="section-label">Section 01</div>
    <h2 class="section-title">Overview &amp; How it works</h2>
    <p>The Perigon time tracking system is built around two tools: <strong>Clockify</strong> for logging time entries, and a <strong>SharePoint Excel workbook</strong> for visibility and reporting. Consultants log their hours in Clockify during the week ‚Äî everything else is handled automatically.</p>
    <p>Every Sunday at 11pm, a Zapier automation fetches all entries from that week and writes them as individual rows into the Master Time Log. By Monday morning, your personal dashboard and Emma's financial view are fully up to date.</p>

    <div class="flow">
      <div class="flow-step"><div class="flow-num">1</div><div class="flow-label">Log time in Clockify daily</div><div class="flow-tool">Clockify</div></div>
      <div class="flow-arrow">&#8594;</div>
      <div class="flow-step"><div class="flow-num">2</div><div class="flow-label">Zapier runs automatically on Sunday at 11pm</div><div class="flow-tool">Zapier</div></div>
      <div class="flow-arrow">&#8594;</div>
      <div class="flow-step"><div class="flow-num">3</div><div class="flow-label">Entries written to Master Time Log</div><div class="flow-tool">SharePoint Excel</div></div>
      <div class="flow-arrow">&#8594;</div>
      <div class="flow-step"><div class="flow-num">4</div><div class="flow-label">Dashboards update automatically</div><div class="flow-tool">Excel formulas</div></div>
    </div>

    <h3>What the system produces</h3>
    <p>Each consultant has a personal dashboard showing their hours logged versus expected hours for each active project ‚Äî giving a clear sense of where they stand on each engagement without exposure to financial details. Emma has a separate restricted tab showing cost rates, charge rates, and margins per consultant per project.</p>

    <div class="callout tip"><div class="callout-icon">&#128161;</div><p><strong>The only thing you need to do is log your time in Clockify.</strong> Everything else ‚Äî syncing to Excel, updating dashboards, calculating totals ‚Äî happens automatically. Just make sure your project names in Clockify exactly match those in the Projects tab.</p></div>

    <h3>Weekly sync timeline</h3>
    <div class="timeline">
      <div class="timeline-item"><div class="time">Mon ‚Äì Sun</div><p>Consultants log time in Clockify against the correct project as they work</p></div>
      <div class="timeline-item"><div class="time">Sunday 11pm</div><p>Zapier automatically fetches the full week's entries from Clockify</p></div>
      <div class="timeline-item"><div class="time">Sunday 11pm ‚Äì ~midnight</div><p>Zapier loops through each entry and writes it as a new row in the TimeLog table in SharePoint</p></div>
      <div class="timeline-item"><div class="time">Monday morning</div><p>All dashboards are current. Review your personal tab to check progress against project budgets.</p></div>
    </div>
  </div>

  <!-- SECTION 2 -->
  <div class="section" id="clockify">
    <div class="section-label">Section 02</div>
    <h2 class="section-title">Logging time in Clockify</h2>

    <h3 id="clockify-daily">Daily time entry</h3>
    <p>Log time in Clockify as you work, or at the end of each day. Avoid leaving entries until the end of the week ‚Äî the more accurate your daily entries, the better the project reporting.</p>
    <ol class="steps">
      <li><strong>Open Clockify</strong> ‚Äî either via the browser app at <code>clockify.me</code>, the desktop app, or the browser extension.<span class="note">The browser extension is the easiest option ‚Äî it lets you start a timer directly from your browser toolbar without switching apps.</span></li>
      <li><strong>Click the play button to start a timer</strong>, or use the manual entry mode to add a completed block of time.</li>
      <li><strong>Select the correct Project</strong> from the project dropdown. Project names must match exactly ‚Äî see the naming rules below.</li>
      <li><strong>Add a task description</strong> in the description field. This populates the Notes/Task column in Excel and is useful context for Emma when reviewing project progress.<span class="note">Examples: "Client discovery call", "Drafting investor deck", "Internal project management".</span></li>
      <li><strong>Save the entry.</strong> That's it ‚Äî the sync to Excel happens automatically on Sunday night.</li>
    </ol>

    <div class="callout warning"><div class="callout-icon">&#9888;&#65039;</div><p><strong>Do not log time against projects that don't exist in the Projects tab.</strong> If a project is missing from Clockify, ask Emma or Sally to add it before you start logging. Entries against unrecognised projects will still sync to the Time Log but won't appear correctly in dashboards.</p></div>

    <h3 id="clockify-naming">Project naming rules</h3>
    <p>The Zapier automation matches time entries to projects using the project name as written in Clockify. If the name doesn't match exactly, the entry will sync to the Time Log but won't feed the correct dashboard calculations.</p>

    <table>
      <thead><tr><th>Rule</th><th>Example</th></tr></thead>
      <tbody>
        <tr><td>Use the exact name as shown in the üìã Projects tab</td><td><code>Apex Capital ‚Äî Strategy Review</code></td></tr>
        <tr><td>Capitalisation matters ‚Äî match it exactly</td><td>Not <code>apex capital ‚Äî strategy review</code></td></tr>
        <tr><td>No trailing spaces or punctuation changes</td><td>Not <code>Apex Capital ‚Äî Strategy Review.</code></td></tr>
        <tr><td>Internal / non-billable work uses internal project codes</td><td><code>Perigon Internal ‚Äî BD</code></td></tr>
      </tbody>
    </table>

    <div class="callout info"><div class="callout-icon">&#8505;&#65039;</div><p>If you're unsure of the exact project name, open the üìã Projects tab in the Master Time Log and copy it from there directly into Clockify.</p></div>

    <h3 id="clockify-weekly">Weekly review before Sunday</h3>
    <p>Before Sunday evening, take a quick look at your Clockify entries for the week to catch any issues before the sync runs.</p>
    <ol class="steps">
      <li><strong>Open Clockify and go to the Reports section</strong> ‚Äî select "This week" as the date range.</li>
      <li><strong>Check all entries have a project assigned.</strong> Any entry without a project won't appear on any dashboard.</li>
      <li><strong>Check descriptions are filled in.</strong> Blank descriptions make it hard for Emma to understand project spend.</li>
      <li><strong>Edit any incorrect entries before 11pm Sunday.</strong> Once the Zap runs, entries are written to Excel and cannot be automatically corrected ‚Äî you'd need to edit the Time Log manually.</li>
    </ol>
  </div>

  <!-- SECTION 3 -->
  <div class="section" id="spreadsheet">
    <div class="section-label">Section 03</div>
    <h2 class="section-title">The Master Time Log spreadsheet</h2>
    <p>The Master Time Log lives in SharePoint at <strong>Business Management &gt; Processes &gt; Tools &gt; Time Tracking Tool</strong>. It is the central hub for all time reporting at Perigon. Do not move or rename it ‚Äî Zapier writes to a specific file path.</p>

    <h3 id="sheets-guide">Sheet-by-sheet guide</h3>

    <div class="sheet-card">
      <div class="sheet-header"><span class="sheet-emoji">üìã</span> Projects <span class="badge badge-auto">Managed by Emma / Sally</span></div>
      <div class="sheet-body">
        <p>The project register. Every active engagement should be listed here with the exact name as it appears in Clockify. Rates for each consultant per project are managed in the üîí Financial View tab and are not visible here.</p>
        <ul>
          <li>Add a new row whenever a new project opens.</li>
          <li>The project name here must match Clockify exactly ‚Äî this is what the dashboards use to pull hours.</li>
          <li>Do not delete old projects ‚Äî archive them by adding "CLOSED" to the name or marking them inactive.</li>
        </ul>
      </div>
    </div>

    <div class="sheet-card">
      <div class="sheet-header"><span class="sheet-emoji">‚è±</span> Time Log <span class="badge badge-auto">Auto-populated by Zapier</span></div>
      <div class="sheet-body">
        <p>The raw data table. Every time entry ever synced from Clockify is stored here as a row. This is the source of truth for all dashboards and reports.</p>
        <ul>
          <li><strong>Do not manually edit rows that were synced from Clockify</strong> ‚Äî if a correction is needed, edit the entry in Clockify and wait for next Sunday's sync, or contact Sally.</li>
          <li>Manual entries can be added for historic data or one-off corrections using the format: Date (DD/MM/YYYY), Consultant, Project, Hours Logged, Notes/Task.</li>
          <li>The table is named <code>TimeLog</code> ‚Äî do not rename it, as Zapier writes to this table by name.</li>
        </ul>
      </div>
    </div>

    <div class="sheet-card">
      <div class="sheet-header"><span class="sheet-emoji">üë§</span> Individual Dashboards (Nick, Emma, Andrew, Sally)</div>
      <div class="sheet-body">
        <p>Each consultant has their own tab showing a live view of hours logged versus expected hours for each active project. Dashboards pull from the Time Log automatically ‚Äî no manual updates needed.</p>
        <ul>
          <li>The progress bar and percentage complete update as new entries are synced each week.</li>
          <li>Only your own data is visible ‚Äî you cannot see other consultants' hours or rates.</li>
          <li>If a project you're working on doesn't appear in your dashboard, check that the project name in Clockify matches the Projects tab exactly.</li>
        </ul>
      </div>
    </div>

    <div class="sheet-card">
      <div class="sheet-header"><span class="sheet-emoji">üîí</span> Financial View <span class="badge badge-restricted">Restricted ‚Äî Emma only</span></div>
      <div class="sheet-body">
        <p>Contains cost rates, charge rates, and calculated margins per consultant per project. This tab should be password-protected so only Emma can access it.</p>
        <ul>
          <li>Emma updates rates here whenever a new project is added or rates change.</li>
          <li>Consultants do not have access to this tab by design ‚Äî margin visibility, while rationally understood, can affect working relationships.</li>
          <li>If rates need updating, contact Emma directly.</li>
        </ul>
      </div>
    </div>

    <div class="sheet-card">
      <div class="sheet-header"><span class="sheet-emoji">üìñ</span> SOP</div>
      <div class="sheet-body">
        <p>A brief in-workbook summary of how to run and maintain this tool. Keep this updated as the team grows or processes change. For the full SOP, refer to this document.</p>
      </div>
    </div>

    <h3 id="dashboard">Reading your personal dashboard</h3>
    <p>Your dashboard gives you a clear picture of where you stand on each project without needing to count up Clockify entries yourself.</p>

    <table>
      <thead><tr><th style="width:38%;">Column</th><th>What it means</th></tr></thead>
      <tbody>
        <tr><td>Project</td><td>The name of the active engagement</td></tr>
        <tr><td>Hours Logged</td><td>Total hours you've recorded in Clockify for this project to date</td></tr>
        <tr><td>Expected Hours</td><td>Your allocated budget for this project (set by Emma in the Financial View)</td></tr>
        <tr><td>Remaining</td><td>Expected Hours minus Hours Logged ‚Äî how much budget you have left</td></tr>
        <tr><td>% Complete</td><td>Progress bar showing hours used as a percentage of your allocation</td></tr>
      </tbody>
    </table>

    <div class="callout warning"><div class="callout-icon">&#9888;&#65039;</div><p><strong>If % Complete is approaching or exceeding 100%, flag this to Emma immediately.</strong> Do not continue logging hours against a project over-budget without checking in first ‚Äî additional hours may not be billable or may need reallocation.</p></div>

    <h3 id="emma-view">Emma's financial view (CEO only)</h3>
    <p>The üîí Financial View gives Emma a full picture of project economics. It shows the cost rate for each consultant (what Perigon pays them), the charge rate (what the client is billed), and the calculated margin for each project.</p>
    <p>Emma should review this tab weekly alongside the individual dashboards to monitor project health and flag any budget concerns to consultants early.</p>

    <div class="callout info"><div class="callout-icon">&#8505;&#65039;</div><p>To protect this tab, go to <strong>Review &gt; Protect Sheet</strong> in Excel and set a password. Share the password only with Emma. If you forget the password, contact Sally who holds the master credentials.</p></div>
  </div>

  <!-- SECTION 4 -->
  <div class="section" id="projects">
    <div class="section-label">Section 04</div>
    <h2 class="section-title">Managing projects</h2>

    <h3>Opening a new project</h3>
    <ol class="steps">
      <li><strong>Emma confirms the project name and consultant allocation</strong> with the team before any time logging begins.</li>
      <li><strong>Add the project to the üìã Projects tab</strong> in the Master Time Log. Use the exact name you want consultants to use in Clockify.</li>
      <li><strong>Add the project to Clockify</strong> ‚Äî navigate to the Workspace settings and create the project there. The name must match the Projects tab exactly.</li>
      <li><strong>Emma adds rates to the üîí Financial View</strong> ‚Äî set the cost rate and charge rate for each consultant who will be working on the engagement.</li>
      <li><strong>Brief the relevant consultants</strong> ‚Äî confirm the Clockify project name and any notes on how to categorise their time (e.g., whether internal project management hours are included in the budget).</li>
    </ol>

    <h3>Closing a project</h3>
    <ol class="steps">
      <li><strong>Ensure all time entries have been logged in Clockify</strong> and the final Sunday sync has run before closing.</li>
      <li><strong>Archive the project in Clockify</strong> ‚Äî this prevents new entries being logged against it accidentally.</li>
      <li><strong>Mark the project as closed in the üìã Projects tab</strong> by adding "(CLOSED)" to the end of the project name.</li>
      <li><strong>Do not delete the project or its rows</strong> from any tab ‚Äî historic data should be preserved for reporting.</li>
    </ol>

    <div class="callout tip"><div class="callout-icon">&#128161;</div><p>Adding new consultants to the team? Duplicate an existing consultant dashboard tab, update the name references in all formulas, and ask Sally to create their Clockify account and add them to the workspace.</p></div>
  </div>

  <!-- SECTION 5 -->
  <div class="section" id="troubleshoot">
    <div class="section-label">Section 05</div>
    <h2 class="section-title">Troubleshooting</h2>
    <p>Work through the relevant checks below before escalating to Sally.</p>

    <div class="trouble-item">
      <div class="trouble-problem">My hours didn't appear in Excel after the Sunday sync</div>
      <div class="trouble-body">
        <div class="trouble-label">Likely causes</div>
        <p>The Zap failed to run, or the entries were logged after the 11pm Sunday cutoff.</p>
        <div class="trouble-label">Steps to resolve</div>
        <ul>
          <li>Check whether the entries exist in Clockify ‚Äî if they're not there, the sync can't pull them.</li>
          <li>Entries logged on Sunday after 11pm will be picked up the <em>following</em> Sunday. If you need them added sooner, add the rows manually to the Time Log using the correct format.</li>
          <li>Ask Sally to check the Zap run history in Zapier ‚Äî failed runs appear in the task history with an error message.</li>
          <li>If the Zap ran successfully but entries are missing, check that the project name in Clockify matched exactly.</li>
        </ul>
      </div>
    </div>

    <div class="trouble-item">
      <div class="trouble-problem">My dashboard shows incorrect hours or a project is missing</div>
      <div class="trouble-body">
        <div class="trouble-label">Likely causes</div>
        <p>Project name mismatch between Clockify and the Projects tab, or a formula referencing the wrong rows.</p>
        <div class="trouble-label">Steps to resolve</div>
        <ul>
          <li>Open the ‚è± Time Log and filter by your name. Check the Project column ‚Äî any entry that doesn't match a project name in the üìã Projects tab will not appear on your dashboard.</li>
          <li>If the project name is wrong in the Time Log, correct it manually in that row.</li>
          <li>If the project simply isn't showing up in your dashboard at all, check that it has been added to the üìã Projects tab and that your dashboard formula includes it. Contact Sally if the formula needs updating.</li>
        </ul>
      </div>
    </div>

    <div class="trouble-item">
      <div class="trouble-problem">A consultant's hours are appearing on the wrong person's dashboard</div>
      <div class="trouble-body">
        <div class="trouble-label">Likely cause</div>
        <p>The consultant name in Clockify doesn't exactly match the name used in dashboard formulas.</p>
        <div class="trouble-label">Steps to resolve</div>
        <ul>
          <li>Open the ‚è± Time Log and check the Consultant column. The value comes directly from the user's full name in Clockify.</li>
          <li>Compare the name in the Time Log with the name referenced in the dashboard formulas ‚Äî they must match exactly.</li>
          <li>To fix: either update the Clockify display name to match, or update the formula references in the dashboard tab. Contact Sally to do this safely.</li>
        </ul>
      </div>
    </div>

    <div class="trouble-item">
      <div class="trouble-problem">The Zap is running but rows are being duplicated in the Time Log</div>
      <div class="trouble-body">
        <div class="trouble-label">Likely cause</div>
        <p>The Zap ran twice for the same week, or a manual entry was added and the Zap also synced the same entry.</p>
        <div class="trouble-label">Steps to resolve</div>
        <ul>
          <li>Check the Zap run history in Zapier for duplicate runs on the same Sunday.</li>
          <li>Manually delete the duplicate rows from the Time Log ‚Äî keep the one that was added by Zapier (identifiable by source if you've added a column for it, or by row order).</li>
          <li>If duplication persists, escalate to Sally to check the Zap trigger settings.</li>
        </ul>
      </div>
    </div>

    <div class="trouble-item">
      <div class="trouble-problem">I need to correct a time entry that's already been synced to Excel</div>
      <div class="trouble-body">
        <div class="trouble-label">Resolution</div>
        <p>The sync is one-way ‚Äî Zapier writes to Excel but doesn't read back from it. Correcting an entry in Clockify will not automatically update what's already been written to the Time Log.</p>
        <div class="trouble-label">Steps to resolve</div>
        <ul>
          <li>Find the relevant row in the ‚è± Time Log and manually edit the Date, Hours Logged, or Notes/Task as needed.</li>
          <li>Do not delete the row ‚Äî edit it in place.</li>
          <li>If the project name needs changing, update that cell and check your dashboard recalculates correctly.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- SECTION 6 -->
  <div class="section" id="zapier">
    <div class="section-label">Section 06</div>
    <h2 class="section-title">Zapier technical reference</h2>
    <p>This section documents the Zap that powers the weekly sync. It is intended for Sally and anyone responsible for maintaining or debugging the automation. Consultants do not need to read this section.</p>

    <h3>Zap overview</h3>
    <p>The Zap is named <strong>Clockify ‚Üí SharePoint Excel Time Log</strong>. It runs automatically every Sunday at 11pm and writes the past week's Clockify entries into the TimeLog table in SharePoint.</p>

    <!-- Step 1 -->
    <div class="zap-step">
      <div class="zap-header"><div class="zap-num">1</div><div><div class="zap-title">Schedule by Zapier</div><div class="zap-app">Trigger</div></div></div>
      <div class="zap-body">
        <p>Kicks off the entire Zap automatically each week ‚Äî no manual action required from anyone.</p>
        <div class="zap-config">
          <div class="zap-row"><span>Trigger event</span><span>Every Week</span></div>
          <div class="zap-row"><span>Day of week</span><span>Sunday</span></div>
          <div class="zap-row"><span>Time</span><span>11:00 PM</span></div>
        </div>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="zap-step">
      <div class="zap-header"><div class="zap-num">2</div><div><div class="zap-title">Run JavaScript ‚Äî Fetch week's entries from Clockify</div><div class="zap-app">Action &nbsp;¬∑&nbsp; Code by Zapier (JavaScript)</div></div></div>
      <div class="zap-body">
        <p>Calculates the date range for the past Monday to Sunday, then calls the Clockify Reports API to fetch all time entries logged in that period. The response is formatted as a block of text with one entry per line (each line is a JSON object).</p>
        <div class="zap-config">
          <div class="zap-row"><span>API endpoint</span><span>reports.api.clockify.me/v1/workspaces/.../reports/detailed</span></div>
          <div class="zap-row"><span>Auth method</span><span>X-Api-Key header</span></div>
          <div class="zap-row"><span>Output</span><span>rows (line-itemised text), count</span></div>
        </div>
        <div class="zap-code-label" style="margin-top:16px;">JavaScript</div>
        <div class="zap-code">const now = new Date();
const day = now.getDay();

const endDate = new Date(now);
const startDate = new Date(now);
startDate.setDate(now.getDate() - day - 6);
startDate.setUTCHours(0, 0, 0, 0);

const response = await fetch(
  'https://reports.api.clockify.me/v1/workspaces/62134ee740f87e49fd8821cc/reports/detailed',
  {
    method: 'POST',
    headers: {
      'X-Api-Key': 'ZGYzZGVhMzAtOGIyNi00NDI1LWIyYTgtZDFlNjMwNDJjOGQ1',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      dateRangeStart: startDate.toISOString(),
      dateRangeEnd: endDate.toISOString(),
      detailedFilter: { page: 1, pageSize: 1000 }
    })
  }
);

const data = await response.json();
const entries = data.timeentries || [];

const rows = entries.map(e => ({
  date: e.timeInterval.start.split('T')[0],
  consultant: e.userName,
  project: e.projectName,
  hours: (e.timeInterval.duration / 3600).toFixed(2),
  notes: e.description || ''
}));

const lineItems = rows.map(r => JSON.stringify(r)).join('\n');
return { rows: lineItems, count: rows.length };</div>
        <div class="callout warning" style="margin-top:16px;"><div class="callout-icon">&#9888;&#65039;</div><p>The API key above is embedded in the code. If it is ever rotated or compromised, update it here in the Zap code step. Do not share the API key externally.</p></div>
      </div>
    </div>

    <!-- Step 3 -->
    <div class="zap-step">
      <div class="zap-header"><div class="zap-num">3</div><div><div class="zap-title">Create Loop from Line-itemized Text</div><div class="zap-app">Action &nbsp;¬∑&nbsp; Looping by Zapier <span class="loop-badge">Loop start</span></div></div></div>
      <div class="zap-body">
        <p>Takes the block of text from Step 2 and splits it into individual items ‚Äî one per time entry ‚Äî so Steps 4 and 5 can process each one separately. Without this step, all entries would be treated as one blob and only a single row would be added to Excel.</p>
        <div class="zap-config">
          <div class="zap-row"><span>Input</span><span>rows output from Step 2</span></div>
          <div class="zap-row"><span>Separator</span><span>New line ([:newline:])</span></div>
        </div>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="zap-step">
      <div class="zap-header"><div class="zap-num">4</div><div><div class="zap-title">Run JavaScript ‚Äî Parse entry into clean fields</div><div class="zap-app">Action &nbsp;¬∑&nbsp; Code by Zapier (JavaScript) <span class="loop-badge">Inside loop</span></div></div></div>
      <div class="zap-body">
        <p>Takes each individual line from the loop (a raw JSON string) and parses it into five clean, usable fields ready to be written to Excel.</p>
        <div class="zap-config">
          <div class="zap-row"><span>Input: row</span><span>Current loop item from Step 3</span></div>
          <div class="zap-row"><span>Outputs produced</span><span>date, consultant, project, hours, notes</span></div>
        </div>
        <div class="zap-code-label" style="margin-top:16px;">JavaScript</div>
        <div class="zap-code">const row = JSON.parse(inputData.row);
return {
  date: row.date,
  consultant: row.consultant,
  project: row.project,
  hours: row.hours,
  notes: row.notes
};</div>
      </div>
    </div>

    <!-- Step 5 -->
    <div class="zap-step">
      <div class="zap-header"><div class="zap-num">5</div><div><div class="zap-title">Microsoft Excel ‚Äî Add Row to Table</div><div class="zap-app">Action &nbsp;¬∑&nbsp; Microsoft Excel (SharePoint) <span class="loop-badge">Inside loop</span></div></div></div>
      <div class="zap-body">
        <p>Writes the parsed fields from Step 4 as a new row in the TimeLog table. This step runs once for every time entry in the loop.</p>
        <div class="zap-config">
          <div class="zap-row"><span>Drive</span><span>SharePoint</span></div>
          <div class="zap-row"><span>Site</span><span>Business Management</span></div>
          <div class="zap-row"><span>File path</span><span>Processes &gt; Tools &gt; Time Tracking Tool &gt; Perigon Master Time Log - Live Version.xlsx</span></div>
          <div class="zap-row"><span>Sheet</span><span>Time Log</span></div>
          <div class="zap-row"><span>Table</span><span>TimeLog</span></div>
          <div class="zap-row"><span>Date</span><span>date from Step 4</span></div>
          <div class="zap-row"><span>Consultant</span><span>consultant from Step 4</span></div>
          <div class="zap-row"><span>Project</span><span>project from Step 4</span></div>
          <div class="zap-row"><span>Hours Logged</span><span>hours from Step 4</span></div>
          <div class="zap-row"><span>Notes/Task</span><span>notes from Step 4</span></div>
        </div>
        <div class="callout info" style="margin-top:16px;"><div class="callout-icon">&#8505;&#65039;</div><p>The table is named <code>TimeLog</code> in the ‚è± Time Log sheet. If you ever need to rebuild the table (e.g. after a file migration), make sure it is given exactly this name or the Zap will fail to find it.</p></div>
      </div>
    </div>

    <h3>Where key files live</h3>
    <table>
      <thead><tr><th style="width:46%;">Location</th><th>Purpose</th></tr></thead>
      <tbody>
        <tr><td style="font-family:monospace;font-size:12px;">SharePoint ‚Üí Business Management ‚Üí Processes ‚Üí Tools ‚Üí Time Tracking Tool ‚Üí Perigon Master Time Log - Live Version.xlsx</td><td>The Master Time Log. Do not move or rename ‚Äî Zapier writes to this exact file path.</td></tr>
        <tr><td style="font-family:monospace;font-size:12px;">Clockify Workspace: Perigon Partners (ID: 62134ee740f87e49fd8821cc)</td><td>Where all consultants log time. Project names here must match the üìã Projects tab.</td></tr>
        <tr><td style="font-family:monospace;font-size:12px;">Zapier ‚Üí Zap: Clockify ‚Üí SharePoint Excel Time Log</td><td>The automation. Check run history here if entries are missing from Excel.</td></tr>
      </tbody>
    </table>

    <div class="callout warning"><div class="callout-icon">&#9888;&#65039;</div><p><strong>If the Excel file is ever renamed, moved, or the SharePoint site is restructured</strong>, the Zap will break at Step 5. Update the file path in the Zapier step immediately and run a test to confirm it's working before the next Sunday sync.</p></div>
  </div>

</div>

<footer>
  Perigon Partners &nbsp;¬∑&nbsp; Time Tracking Tool SOP v1.0 &nbsp;¬∑&nbsp; February 2026 &nbsp;¬∑&nbsp; Maintained by Sally Weatherly
</footer>

</body>
</html>
